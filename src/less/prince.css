/* Page layout */

@prince-pdf {
  prince-pdf-open-action: zoom(fit-height);
  prince-pdf-page-layout: two-page-right;
}

@page {
  size    : 6in 9in;
  margin  : 0.67in 0.67in 1.25in 0.67in;
  padding : 0;
  border  : 0;

  @bottom       { font-variant: prince-opentype(dlig, onum); }
  @bottom-left  { font-variant: prince-opentype(dlig, onum); }
  @bottom-right { font-variant: prince-opentype(dlig, onum); }
}

@page:left {
  @bottom      { font-size: 60%; font-family: gill-sans-nova; font-weight: 400; content: "Energy Reality"; }
  @bottom-left { font-size: 60%; font-family: gill-sans-nova; font-weight: 600; content: counter(page); }
}

@page:right {
  @bottom       { font-size: 60%; font-family: gill-sans-nova; font-weight: 400; content: "Chapter " counter(chapter) " - " string(h1text); }
  @bottom-right { font-size: 60%; font-family: gill-sans-nova; font-weight: 600; content: counter(page); }
}

html, body {
  margin  : 0;
  padding : 0;
  border  : 0;
}

body {
  counter-reset : page 1 pages 1 h1c 1 h2c 1 h3c 1 h4c 1 h5c 1 h6c 1 chapter 1;
}





/* generated content */

currentYear { content: prince-script(getCurrentYear); }





/* Font faces */

@font-face {
  font-family : "gill-sans-nova";
  src         : url("gill-sans-nova-700.otf") format("opentype");
  font-style  : normal;
  font-weight : 700;
}

@font-face {
  font-family : "gill-sans-nova";
  src         : url("gill-sans-nova-600.otf") format("opentype");
  font-style  : normal;
  font-weight : 600;
}

@font-face {
  font-family : "gill-sans-nova";
  src         : url("gill-sans-nova-500.otf") format("opentype");
  font-style  : normal;
  font-weight : 500;
}

@font-face {
  font-family : "gill-sans-nova";
  src         : url("gill-sans-nova-400.otf") format("opentype");
  font-style  : normal;
  font-weight : 400;
}



@font-face {
  font-family : "minion-pro-display";
  src         : url("minion-pro-display-700.otf") format("opentype");
  font-style  : normal;
  font-weight : 700;
}

@font-face {
  font-family : "minion-pro-display";
  src         : url("minion-pro-display-400.otf") format("opentype");
  font-style  : normal;
  font-weight : 400;
}

@font-face {
  font-family : "minion-pro";
  src         : url("minion-pro-400.otf") format("opentype");
  font-style  : normal;
  font-weight : 400;
}



@font-face {
  font-family : "nymphette";
  src         : url("Nymphette.ttf") format("truetype");
  font-style  : normal;
  font-weight : 400;
}





/* Fonts */

body, p                { font-family: minion-pro; orphans: 2; widows: 2; }
h1, h2, h3, h4, h5, h6 { font-family: gill-sans-nova; font-weight: 500; }





/* Structural */

p {
  text-align  : justify;
  text-indent : 2em;
  line-height : 145%;
}

h1 {
  page-break-before : left;
  page-break-after  : always;
  text-align        : center;
  margin            : 7em 2em 0 2em;
  counter-increment : h1c;
  counter-increment : chapter;
  counter-reset     : h2c h3c h4c h5c h6c;
  string-set        : h1text content();
}

h1::before {
  display       : block;
  margin-bottom : 2em;
  font-size     : 50%;
  color         : #888;
  content       : "Chapter " counter(chapter);
}

h2 {
  page-break-before: always;
  counter-increment : h2c;
  counter-reset     : h3c h4c h5c h6c;
}

h3 {
  margin-top        : 2.5em;
  counter-increment : h3c;
  counter-reset     : h4c h5c h6c;
}

h4 {
  margin-top        : 2em;
  counter-increment : h4c;
  counter-reset     : h5c h6c;
}

h5 {
  margin-top        : 1.5em;
  counter-increment : h5c;
  counter-reset     : h6c;
}

h6 {
  counter-increment : h6c;
}

/* not toc, foreword, acknowledgements, prologue, preface, introduction, lists of tables/figures because they have h1 */
/* not halftitle because it's the first page */
#frontispiece, #copyright, #dedication, #epigraph, #title, #second_half_title {
  page-break-before: always;
}

/* so that it will show up in the toc, but not on page */
#halftitle h1 { display: none; page-break-before: avoid; }





/* typical */

table   { border-collapse: collapse; border: 0.03em solid #444; break-inside: avoid; }
th      { border-bottom: 0.02em solid #888; background-color: #eee; }
th, td  { margin: 0; padding: 0.2em 0.5em; text-align: left; }
td + td { border-left: 0.02em solid #888; }

blockquote         { margin: 1rem 2rem; padding: 0.2rem 1.5rem; background-color: #eee; border: solid #bbb; border-width: 0.02rem 0.02rem 0.02rem 0.3rem }
blockquote::before { color: #bbb; position: absolute; font-size: 900%; content: "â€œ"; font-family: minion-pro-display; margin: -0.12em 0 0 -0.19em; }

cite               { display: block; text-align: right; margin: 1em 2rem 0 0; }
cite::before       { content: "- "; }

img { max-width: 100%; }





/* Book section rule triggers */

#prince_anchor_book_content { counter-reset : page 1; }
#prince_anchor_back_matter  { counter-reset : page 1; }





/* halftitle page rules */

#halftitle        { page: halftitle; counter-reset : page 1; }
#halftitle .title { font-size: 300%; font-weight: 700; text-align: center; margin-top: 5em; }




/* frontispiece rules */

#frontispiece      { page: frontispiece; }
#frontispiece img  { width: 100%; margin-top: 3em; }
#frontispiece span { display: block; text-align: center; color: white; margin-top: 4em; font-size: 150%; }

@page frontispiece { background-color: black; }





/* title page rules */

#title           { page: title; }
#title .title    { margin-top: 4em;   font-weight: 700; font-size: 300%; }
#title .subtitle { margin-top: 0.5em; font-weight: 400; font-size: 150%; }

#title .title, #title .subtitle { text-align: center; font-family: minion-pro-display; }

#title .author { font-family: gill-sans-nova; margin-top: 8em; text-align: center; }
#title .press  { font-family: gill-sans-nova; position: absolute; bottom: 2em; left: 0; right: 0; }

#title .press .right     { float: right; }
#title .press .publisher { font-weight: bold; color: #333; }





/* copyright page rules */

#copyright       { page: copyright; }
#copyright table { margin: 2em auto; }





/* dedication page rules */

#dedication { page: dedication; }





/* epigraph rules */

#epigraph            { page: epigraph; }





/* Table of Contents pages */

#tocbox {
  page              : tocpage;
  page-break-before : left;
  page-break-after  : always;
}

#tocbox #tocheading {
  font-variant : small-caps;
  font         : gill-sans-nova 700;
  font-size    : 200%;
  margin       : 0 0 1em 0;
  padding      : 0;
  text-align   : center;
}

#tocbox #tocheading::before,
#tocbox #tocheading::after   {
  font-family  : nymphette, monospace;
  font-weight  : 400;
  font-variant : normal;
  font-size    : 80%;
  color        : #888;
}

#tocbox #tocheading::before { content : 'g'; padding-right : 0.5em; }
#tocbox #tocheading::after  { content : 'h'; padding-left  : 0.5em; }

#tocbox .table-of-contents                     { counter-reset: toc_chap_ctr -2; }

#tocbox .table-of-contents>ul                  { font-size: 0.6rem; columns: 2; column-gap: 4em; column-rule: 0.025em solid #ccc; }

#tocbox .table-of-contents ::marker            { margin-right: 0.1em; padding-right: 0.1em; font-size: 70%; opacity: 0.3; font-weight: bold; }
#tocbox .table-of-contents>ul>li::marker       { content: 'i'; }
#tocbox .table-of-contents>ul>li+li::marker    { content: 'ii'; }
#tocbox .table-of-contents>ul>li+li+li::marker { content: counter(toc_chap_ctr); }

#tocbox .table-of-contents ul,
#tocbox .table-of-contents ul li               { margin: 0; padding: 0; border: 0; line-height: 110%; }
#tocbox .table-of-contents ul li li            { margin-left: 1.5em; font-size: 0.5rem; color: #555; }
#tocbox .table-of-contents ul li li li         { color: #888; }
#tocbox .table-of-contents ul li ul            { margin-bottom: 0.25em; }
#tocbox .table-of-contents ul li+li            { margin-top: 0.25em; }

#tocbox .table-of-contents>ul>li>ul            { margin-top: 0.35em; }
#tocbox .table-of-contents>ul>li+li            { margin-top: 1.5em; }

#tocbox .table-of-contents ul li a             { color: inherit; text-decoration: none; }

#tocbox .table-of-contents>ul>li               { list-style-type: decimal; counter-increment: toc_chap_ctr; }
#tocbox .table-of-contents>ul>li li            { list-style-type: none; }

#tocbox .table-of-contents ul li a::after {
  font-variant : prince-opentype(tnum);
  font-size    : 0.5rem;
  content      : leader(' . ') " " target-counter(attr(href, url), page);
}





/* prelude rules */

h1#slug-prelude::before { page: prelude; content: ""; }





/* acknowledgements / the stewards who we need to support rules */

h1#slug-the-stewards-who-we-need-to-support::before { content: "Acknowledgements"; }





/* ch1 collectively preventing self destruction rules */

h1#slug-collectively-preventing-self-destruction { counter-reset: chapter 0; }





/* And finally, page construction rules */
/* unfortunately they aren't repeatable with comma :( */

@page tocpage {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page halftitle {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page title {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page copyright {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page dedication {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page epigraph {
  padding-top: 1rem;
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page listoffigures {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page listoftables {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page prelude {
  @bottom-right { background: transparent; content: ""; }
  @bottom       { background: transparent; content: ""; }
  @bottom-left  { background: transparent; content: ""; }
}

@page:blank {
  @bottom-left  { content: ""; }
  @bottom       { content: ""; }
  @bottom-right { content: ""; }
}
